<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>My Project: Scattering.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Scattering.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_scattering_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef CRYSTAL_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="_crystal_8hpp.html">Crystal.hpp</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//const double Eps1 = 1.7453292431333680334067268304459e-4; //cos(89.99)</span></div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="_scattering_8cpp.html#a313458e459a6edadbb1173c43e9ff7b2">    7</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_scattering_8cpp.html#a313458e459a6edadbb1173c43e9ff7b2">Eps1</a> = 1.7453292519943295769148298069306e-10; <span class="comment">//cos(89.99999999)</span></div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="_scattering_8cpp.html#a3ab3c33e22e8dc6b261b0b455963caf3">    8</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_scattering_8cpp.html#a3ab3c33e22e8dc6b261b0b455963caf3">Eps2</a> = 0.99999999998254670756866631966593; <span class="comment">//1- cos(89.99999999)</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// tracing of the separated beam bm from facet k INSIDE particle</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keywordtype">int</span> Crystal::TracingOfInternalBeam ( <a class="code" href="class_beam.html">Beam</a>&amp; inc_beam, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <a class="code" href="group__particles.html#ga5701ef1bab827bd012b63be081759c80">Hand</a> <a class="code" href="main_8cpp.html#a624f88d19899dcade5d794ee32c09ffb">Handler</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">    #ifdef _DEBUG</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor"></span>        <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mncnt = 0;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        mncnt++;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(<a class="code" href="matrix_8cpp.html#aecb251516c02fd2544f242ab0561a125">norm</a>(inc_beam()) &lt; <a class="code" href="class_beam_splitting.html#a98f744dd3b7891604e9c8ecad31d8846">Ep</a>)  <span class="keywordflow">return</span> 0;  </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">if</span>(cnt &gt;= <a class="code" href="class_beam_splitting.html#a3aa9abcd451d17c2294aedb896003f76">Itr</a>)             <span class="keywordflow">return</span> 1; <span class="comment">// safe return</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    cnt++;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *faces_cnt;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    faces_cnt = <a class="code" href="class_beam_splitting.html#a6606ec0292151c801624986bd16e38d3">Facets</a>[cnt];</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l=0; l&lt;this-&gt;<a class="code" href="class_frame.html#ae4b6cfa6b7d944f90fe59af50fbbf620">K</a>; l++) { <span class="comment">// facet loop</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordflow">if</span>(!faces_cnt[l]) <span class="keywordflow">continue</span>; <span class="comment">// if this facet is out of interest</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">if</span>(l == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_point3_d.html">Point3D</a> n = this-&gt;<a class="code" href="class_crystal.html#ae67a372aa591a6968113b5c8b53de4dd">NormToFacet</a>(l); </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> csa = n*inc_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">if</span>(csa &lt; <a class="code" href="_scattering_8cpp.html#a313458e459a6edadbb1173c43e9ff7b2">Eps1</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        std::list&lt;Point3D&gt; Result;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="class_crystal.html#a553c992053e8241457eea813496007a6">Intersection</a>(inc_beam,l,Result)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="class_beam.html">Beam</a> Reflected(Result), <span class="comment">// internal (reflected) beam</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;             Refracted(Result); <span class="comment">// outgoing beam</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        std::list&lt;unsigned int&gt;::const_iterator fs = inc_beam.<a class="code" href="class_beam.html#ae7cabaf6f67e1f4b9b3c0537dd807ae7">BeginP</a>();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">for</span>(;fs!=inc_beam.<a class="code" href="class_beam.html#a01db8ce4e2b6f733ddb9f86b4460c208">EndP</a>(); fs++) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            Reflected.PushBackP(*fs);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            Refracted.<a class="code" href="class_beam.html#a0d75fe2046df54caef37336cf4ffabe6">PushBackP</a>(*fs);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        Reflected.PushBackP(l);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        Refracted.<a class="code" href="class_beam.html#a0d75fe2046df54caef37336cf4ffabe6">PushBackP</a>(l);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordtype">double</span> sqr_csa = <a class="code" href="service_8hpp.html#a326c724913d3f080754a57ebe3892581">SQR</a>(csa),Nr = (this-&gt;<a class="code" href="class_crystal.html#a7fb2731da0adf9914b11e9fcf5066308">mr</a>+<a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(<a class="code" href="service_8hpp.html#a326c724913d3f080754a57ebe3892581">SQR</a>(this-&gt;<a class="code" href="class_crystal.html#a7fb2731da0adf9914b11e9fcf5066308">mr</a>)+this-&gt;<a class="code" href="class_crystal.html#aa698b3e27f190194b410fd3e6929ce51">mi</a>/sqr_csa))/2.0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">if</span>(csa &gt;= <a class="code" href="_scattering_8cpp.html#a3ab3c33e22e8dc6b261b0b455963caf3">Eps2</a>) { <span class="comment">// case of the normal incidence</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="keyword">const</span> <a class="code" href="classcomplex.html">complex</a> Tref = 2.0*this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>/(1.0+this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            Refracted(0,0) = Tref*inc_beam(0,0);    Refracted(0,1) = Tref*inc_beam(0,1);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            Refracted(1,0) = Tref*inc_beam(1,0);    Refracted(1,1) = Tref*inc_beam(1,1);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            Refracted.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = inc_beam.e;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            Refracted.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a> = inc_beam.r;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keyword">const</span> <a class="code" href="classcomplex.html">complex</a> Rref = (1.0-this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>)/(1.0+this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>); </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            Reflected(0,0) = Rref*inc_beam(0,0);    Reflected(0,1) = Rref*inc_beam(0,1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            Reflected(1,0) = -Rref*inc_beam(1,0);   Reflected(1,1) = -Rref*inc_beam(1,1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            Reflected.e =  inc_beam.e;<span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            Reflected.r = -inc_beam.r;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_crystal.html#ad04bd5ec204e07f5bdde263743f53e2c">Phase</a>()) { <span class="comment">// optical path</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keyword">const</span> <a class="code" href="class_point3_d.html">Point3D</a> pnt = <a class="code" href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a>(Reflected);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                Refracted.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a> = -pnt*Refracted.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                Reflected.D = -pnt*Reflected.r;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                Reflected.lng =  inc_beam.lng + <a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(Nr)*fabs(inc_beam.r*pnt+inc_beam.D);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                Refracted.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> = Reflected.lng + fabs(<a class="code" href="class_beam_splitting.html#aee0b1d861b8174466de4b3c87b69453d">d</a>+Refracted.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            std::list&lt;Point3D&gt;::const_iterator <a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a> = Refracted.<a class="code" href="class_beam.html#a43e4f0f9235e94a6e53fc3a5d3dfdf39">Begin</a>();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> p0 = *<a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a>, p1 = *++<a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a>, pcnt = <a class="code" href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a>(Refracted);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> pp0=p0-pcnt,pp1=p1-pcnt; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> pv=pp1%pp0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (pv*Refracted.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>&lt;0.0) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                Refracted.<a class="code" href="class_beam.html#ac18b7f524b8ea54319af49b0e75142cd">Clear</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                p = Result.begin();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;Result.size(); p++, j++)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    Refracted.<a class="code" href="class_beam.html#a23cd1b4273b246c2aaca30d8d596ae29">PushFront</a>(*p);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            } </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            Refracted.<a class="code" href="class_beam.html#a2b26e5f62f5ce4fa9f05c4e6e57c653a">N</a> = n;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="main_8cpp.html#a624f88d19899dcade5d794ee32c09ffb">Handler</a>(Refracted.<a class="code" href="class_beam.html#a02e4f12058c4543df6a3b5a33c15f41f">Rotate</a>(<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>, <a class="code" href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">Ey</a>)); <span class="comment">// treating of the outgoing beam</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">else</span> { <span class="comment">// case of the sloping incidence</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> R = inc_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>/csa-n, T = R-n;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            T /= length(T);  </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordtype">double</span> s = 1.0/(Nr*sqr_csa)-<a class="code" href="matrix_8cpp.html#aecb251516c02fd2544f242ab0561a125">norm</a>(R), csta;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> Eh = n%inc_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>; <span class="comment">// perpendicular to the scattering plane</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            Eh/=length(Eh);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="class_beam.html">Beam</a> bm = inc_beam.<a class="code" href="class_beam.html#ac0da7147ef1655a5487b8984ab777c70">RotatePlane</a>(Eh);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            Reflected.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = Eh;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            Reflected.r = T;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span>(s &gt; DBL_EPSILON) { </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                R = R/<a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(s)+n;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                R /= length(R); <span class="comment">// direction of the escaping ray</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                csta = n*R;   <span class="comment">// refraction angle</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="keyword">const</span> <a class="code" href="classcomplex.html">complex</a>   bf = 2.0*this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa,       </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                bTv = this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csta + csa, </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                bTh = this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa + csta; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <a class="code" href="classcomplex.html">complex</a> Tv = bf/bTv, Th = bf/bTh;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="comment">// outgoing beam</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                Refracted(0,0) = Tv*bm(0,0);    Refracted(1,0) = Th*bm(1,0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                Refracted(0,1) = Tv*bm(0,1);    Refracted(1,1) = Th*bm(1,1);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                Refracted.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = Eh;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                Refracted.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a> = R;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_crystal.html#ad04bd5ec204e07f5bdde263743f53e2c">Phase</a>()) { <span class="comment">// optical path</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    <span class="keyword">const</span> <a class="code" href="class_point3_d.html">Point3D</a> pnt = <a class="code" href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a>(Reflected);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    Reflected.D = -pnt*T;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    Refracted.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a> = -pnt*R;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    Reflected.lng = inc_beam.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> + <a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(Nr)*fabs(inc_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>*pnt+inc_beam.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    Refracted.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> = Reflected.lng + fabs(<a class="code" href="class_beam_splitting.html#aee0b1d861b8174466de4b3c87b69453d">d</a>+Refracted.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                std::list&lt;Point3D&gt;::const_iterator <a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a> = Refracted.<a class="code" href="class_beam.html#a43e4f0f9235e94a6e53fc3a5d3dfdf39">Begin</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <a class="code" href="class_point3_d.html">Point3D</a> p0 = *<a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a>, p1 = *++<a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a>, pcnt = <a class="code" href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a>(Refracted);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <a class="code" href="class_point3_d.html">Point3D</a> pp0=p0-pcnt,pp1=p1-pcnt; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <a class="code" href="class_point3_d.html">Point3D</a> pv=pp1%pp0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">if</span> (pv*Refracted.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>&lt;0.0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    Refracted.<a class="code" href="class_beam.html#ac18b7f524b8ea54319af49b0e75142cd">Clear</a>();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    p = Result.begin();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;Result.size(); p++, j++)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        Refracted.<a class="code" href="class_beam.html#a23cd1b4273b246c2aaca30d8d596ae29">PushFront</a>(*p);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                } <span class="comment">//</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                Refracted.<a class="code" href="class_beam.html#a2b26e5f62f5ce4fa9f05c4e6e57c653a">N</a> = n;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <a class="code" href="main_8cpp.html#a624f88d19899dcade5d794ee32c09ffb">Handler</a>(Refracted.<a class="code" href="class_beam.html#a02e4f12058c4543df6a3b5a33c15f41f">Rotate</a>(<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>,<a class="code" href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">Ey</a>)); <span class="comment">// treating of the escaping beam</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                Tv = (csa-this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csta) / bTv;  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                Th = (this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa-csta) / bTh;   <span class="comment">// internal field</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                Reflected(0,0) = Tv*bm(0,0);  Reflected(0,1) = Tv*bm(0,1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                Reflected(1,0) = Th*bm(1,0);  Reflected(1,1) = Th*bm(1,1);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">else</span> { <span class="comment">// case of the complete internal reflection</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> bf = Nr*(1.0-sqr_csa)-1.0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">                #ifdef _DEBUG</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor"></span>                    <span class="keywordflow">if</span>(bf &lt; 0.0) <span class="keywordflow">throw</span> <span class="stringliteral">&quot;TracingOfInternalBeam : Error!&quot;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor"></span>                <span class="keyword">const</span> <a class="code" href="classcomplex.html">complex</a> sq(0, bf&gt;0?<a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(bf):0);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="classcomplex.html">complex</a> Rv = (csa-this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*sq)/(this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*sq+csa), </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        Rh = (this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa-sq)/(this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa+sq); </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                Reflected(0,0) = Rv*bm(0,0);    Reflected(0,1) = Rv*bm(0,1);<span class="comment">// reflected field</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                Reflected(1,0) = Rh*bm(1,0);    Reflected(1,1) = Rh*bm(1,1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_crystal.html#ad04bd5ec204e07f5bdde263743f53e2c">Phase</a>()) { <span class="comment">// optical path</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    <span class="keyword">const</span> <a class="code" href="class_point3_d.html">Point3D</a> pnt = <a class="code" href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a>(Reflected);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    Reflected.D = -pnt*Reflected.r;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    Reflected.lng = inc_beam.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> + <a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(Nr)*fabs(inc_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>*pnt+inc_beam.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            } <span class="comment">// end of if... else...</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">//if(CrossSection(Reflected) &lt; S_eps) continue;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">// treating of the internal field</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        this-&gt;TracingOfInternalBeam(Reflected, l, Handler);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    } <span class="comment">// end of loop</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    cnt--;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">// face-tracing code</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// starting routine</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="class_crystal.html#a4742173e9d9c0f25cb4ad4d0bfa9f7a6">  158</a></span>&#160;<span class="keywordtype">double</span>  <a class="code" href="class_crystal.html#a4742173e9d9c0f25cb4ad4d0bfa9f7a6">Crystal::FTforConvexCrystal</a>(<a class="code" href="group__particles.html#ga5701ef1bab827bd012b63be081759c80">Hand</a> <a class="code" href="main_8cpp.html#a624f88d19899dcade5d794ee32c09ffb">Handler</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">double</span> s = 0, csa, csta; <span class="comment">// the area of the particle projection</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *faces_0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    faces_0 = <a class="code" href="class_beam_splitting.html#a6606ec0292151c801624986bd16e38d3">Facets</a>[0];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l=0; l&lt;this-&gt;<a class="code" href="class_frame.html#ae4b6cfa6b7d944f90fe59af50fbbf620">K</a>; l++) { <span class="comment">// facet loop</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">if</span>(!faces_0[l]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_point3_d.html">Point3D</a> n = this-&gt;<a class="code" href="class_crystal.html#ae67a372aa591a6968113b5c8b53de4dd">NormToFacet</a>(l);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        csa = <a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>*n;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span>(csa &lt; <a class="code" href="_scattering_8cpp.html#a313458e459a6edadbb1173c43e9ff7b2">Eps1</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="class_beam.html">Beam</a> ext_beam, int_beam; <span class="comment">//</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span>(csa &gt;= <a class="code" href="_scattering_8cpp.html#a3ab3c33e22e8dc6b261b0b455963caf3">Eps2</a>) { <span class="comment">// case of the normal incidence</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            int_beam(0,0) = int_beam(1,1) = 2.0/(this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>+1.0); <span class="comment">// internal field</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            int_beam.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = <a class="code" href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">Ey</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            int_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a> = -<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            ext_beam(0,0)= (this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>-1.0)/(this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>+1.0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            ext_beam(1,1)= -(this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>-1.0)/(this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>+1.0); </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            ext_beam.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = <a class="code" href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">Ey</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            ext_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a> = <a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>; <span class="comment">//</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordtype">double</span>  sqr_csa = <a class="code" href="service_8hpp.html#a326c724913d3f080754a57ebe3892581">SQR</a>(csa), </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    Nr = (this-&gt;<a class="code" href="class_crystal.html#a7fb2731da0adf9914b11e9fcf5066308">mr</a>+1.0-sqr_csa+<a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(<a class="code" href="service_8hpp.html#a326c724913d3f080754a57ebe3892581">SQR</a>(this-&gt;<a class="code" href="class_crystal.html#a7fb2731da0adf9914b11e9fcf5066308">mr</a>+sqr_csa-1.0)+this-&gt;<a class="code" href="class_crystal.html#aa698b3e27f190194b410fd3e6929ce51">mi</a>))/2.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> T = n-<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>/csa, </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    R = n+T;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            R /= length(R); <span class="comment">// direction of the external beam</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            T = (T/<a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>((Nr/sqr_csa)-<a class="code" href="matrix_8cpp.html#aecb251516c02fd2544f242ab0561a125">norm</a>(T)))-n;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            T /= length(T);  <span class="comment">// internal ray</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            csta = -n*T;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> Eh = -n%<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> NormEh = <a class="code" href="matrix_8cpp.html#aecb251516c02fd2544f242ab0561a125">norm</a>(Eh);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            int_beam.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = <a class="code" href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">Ey</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            int_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a> = -<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            Eh /= <a class="code" href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a>(NormEh);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            int_beam = int_beam.<a class="code" href="class_beam.html#ac0da7147ef1655a5487b8984ab777c70">RotatePlane</a>(Eh); </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="classcomplex.html">complex</a> bfTv = this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa + csta,  </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    bfTh = this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csta + csa,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    Tv = (this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csa-csta) / bfTv, </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    Th = (csa-this-&gt;<a class="code" href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">RefI</a>*csta) / bfTh; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            ext_beam(0,0) = Tv*int_beam(0,0);   ext_beam(0,1) = Tv*int_beam(0,1);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            ext_beam(1,0) = Th*int_beam(1,0);   ext_beam(1,1) = Th*int_beam(1,1);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            ext_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a> = R; <span class="comment">// direction of the external beam</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            ext_beam.<a class="code" href="class_beam.html#ade2d828589f214cc25af43206416393b">e</a> = int_beam.e; <span class="comment">// direction of the external beam</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            Tv = 2.0*csa/bfTv;      Th = 2.0*csa/bfTh;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            int_beam(0,0) *= Tv;    int_beam(0,1) *= Tv; <span class="comment">// internal field</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            int_beam(1,0) *= Th;    int_beam(1,1) *= Th; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            int_beam.r = T; <span class="comment">// direction of the internal beam</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// vertexes of the external and internal beams</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; this-&gt;<a class="code" href="class_frame.html#aa6e48af345f0a03c5a25ec72c4454057">Gr</a>[l][j+1]!=-1 &amp;&amp; j&lt;this-&gt;<a class="code" href="class_frame.html#a95169b5c5d1d072b4d17cad40c7e41f7">Km</a>; j++) { <span class="comment">// edge loop</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            ext_beam.<a class="code" href="class_beam.html#a23cd1b4273b246c2aaca30d8d596ae29">PushFront</a>(this-&gt;<a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a>[this-&gt;<a class="code" href="class_frame.html#aa6e48af345f0a03c5a25ec72c4454057">Gr</a>[l][j]]);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            int_beam.<a class="code" href="class_beam.html#a23cd1b4273b246c2aaca30d8d596ae29">PushFront</a>(this-&gt;<a class="code" href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">p</a>[this-&gt;<a class="code" href="class_frame.html#aa6e48af345f0a03c5a25ec72c4454057">Gr</a>[l][j]]);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_crystal.html#ad04bd5ec204e07f5bdde263743f53e2c">Phase</a>()) {  <span class="comment">// taking into account the optical path of the beams</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="class_point3_d.html">Point3D</a> pnt = <a class="code" href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a>(int_beam);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            int_beam.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a> = -int_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>*pnt;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            ext_beam.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a> = -ext_beam.<a class="code" href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">r</a>*pnt;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            int_beam.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> = <a class="code" href="class_beam_splitting.html#aee0b1d861b8174466de4b3c87b69453d">d</a>-<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>*pnt;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            ext_beam.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> = int_beam.<a class="code" href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">lng</a> + fabs(<a class="code" href="class_beam_splitting.html#aee0b1d861b8174466de4b3c87b69453d">d</a>+ext_beam.<a class="code" href="class_beam.html#a98851e57137d162d08b283ff759b2a97">D</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        ext_beam.<a class="code" href="class_beam.html#a5932942c7a738649a29173849bfa722b">PushFrontP</a>(l);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        int_beam.<a class="code" href="class_beam.html#a5932942c7a738649a29173849bfa722b">PushFrontP</a>(l);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        s += <a class="code" href="beam_8cpp.html#ade74cd1c657f89aec3feae714eab6320">AreaOfBeam</a>(ext_beam)*csa; <span class="comment">// equal to call of CrossSection(ext_beam)</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        ext_beam.<a class="code" href="class_beam.html#a2b26e5f62f5ce4fa9f05c4e6e57c653a">N</a> = n;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="main_8cpp.html#a624f88d19899dcade5d794ee32c09ffb">Handler</a>(ext_beam.<a class="code" href="class_beam.html#a02e4f12058c4543df6a3b5a33c15f41f">Rotate</a>(<a class="code" href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">k</a>,<a class="code" href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">Ey</a>)); <span class="comment">// handling of the outgoing beam</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// handling of the internal beam</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        this-&gt;TracingOfInternalBeam(int_beam, l, Handler);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    } <span class="comment">// end of facet loop</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="ttc" id="class_beam_html_a98851e57137d162d08b283ff759b2a97"><div class="ttname"><a href="class_beam.html#a98851e57137d162d08b283ff759b2a97">Beam::D</a></div><div class="ttdeci">double D</div><div class="ttdoc">current position of phase front from Ax+By+Cz+D=0 </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00039">Beam.hpp:39</a></div></div>
<div class="ttc" id="class_crystal_html_a553c992053e8241457eea813496007a6"><div class="ttname"><a href="class_crystal.html#a553c992053e8241457eea813496007a6">Crystal::Intersection</a></div><div class="ttdeci">bool Intersection(const Beam &amp;Bm, unsigned int i, std::list&lt; Point3D &gt; &amp;pl) const </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8cpp_source.html#l00117">Crystal.cpp:117</a></div></div>
<div class="ttc" id="group__particles_html_ga5701ef1bab827bd012b63be081759c80"><div class="ttname"><a href="group__particles.html#ga5701ef1bab827bd012b63be081759c80">Hand</a></div><div class="ttdeci">void(* Hand)(Beam &amp;)</div><div class="ttdoc">Function prototype witch should be used for handling the outgoing beam in main program. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00029">Crystal.hpp:29</a></div></div>
<div class="ttc" id="classcomplex_html"><div class="ttname"><a href="classcomplex.html">complex</a></div><div class="ttdoc">This class provides a complex numbers and operation with them. </div><div class="ttdef"><b>Definition:</b> <a href="compl_8hpp_source.html#l00029">compl.hpp:29</a></div></div>
<div class="ttc" id="class_beam_splitting_html_a30ff1718745251ba4640243db464f090"><div class="ttname"><a href="class_beam_splitting.html#a30ff1718745251ba4640243db464f090">BeamSplitting::k</a></div><div class="ttdeci">Point3D k</div><div class="ttdoc">Direction to the incident wave. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00042">Crystal.hpp:42</a></div></div>
<div class="ttc" id="class_frame_html_a95169b5c5d1d072b4d17cad40c7e41f7"><div class="ttname"><a href="class_frame.html#a95169b5c5d1d072b4d17cad40c7e41f7">Frame::Km</a></div><div class="ttdeci">unsigned int Km</div><div class="ttdoc">Maximal count of vertexes at any facet. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00069">Crystal.hpp:69</a></div></div>
<div class="ttc" id="class_beam_splitting_html_a98f744dd3b7891604e9c8ecad31d8846"><div class="ttname"><a href="class_beam_splitting.html#a98f744dd3b7891604e9c8ecad31d8846">BeamSplitting::Ep</a></div><div class="ttdeci">double Ep</div><div class="ttdoc">the level of negligibility energy </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00044">Crystal.hpp:44</a></div></div>
<div class="ttc" id="class_beam_splitting_html_a2f4c8359b094c42e6dec5f0c7d08569d"><div class="ttname"><a href="class_beam_splitting.html#a2f4c8359b094c42e6dec5f0c7d08569d">BeamSplitting::Ey</a></div><div class="ttdeci">Point3D Ey</div><div class="ttdoc">Normal to the incident plane. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00042">Crystal.hpp:42</a></div></div>
<div class="ttc" id="beam_8cpp_html_aebff45a2b6a4d30ee5b5e41870db4dd4"><div class="ttname"><a href="beam_8cpp.html#aebff45a2b6a4d30ee5b5e41870db4dd4">CenterOfBeam</a></div><div class="ttdeci">Point3D CenterOfBeam(const Beam &amp;bm)</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00074">beam.cpp:74</a></div></div>
<div class="ttc" id="class_frame_html_ab237ca40a24213f4e3800dc082f0af68"><div class="ttname"><a href="class_frame.html#ab237ca40a24213f4e3800dc082f0af68">Frame::p</a></div><div class="ttdeci">Point3D * p</div><div class="ttdoc">Coordinates of vertexes of the crystal. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00078">Crystal.hpp:78</a></div></div>
<div class="ttc" id="class_beam_html_a23cd1b4273b246c2aaca30d8d596ae29"><div class="ttname"><a href="class_beam.html#a23cd1b4273b246c2aaca30d8d596ae29">Beam::PushFront</a></div><div class="ttdeci">void PushFront(const Point3D &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00093">Beam.hpp:93</a></div></div>
<div class="ttc" id="class_crystal_html_ae67a372aa591a6968113b5c8b53de4dd"><div class="ttname"><a href="class_crystal.html#ae67a372aa591a6968113b5c8b53de4dd">Crystal::NormToFacet</a></div><div class="ttdeci">Point3D NormToFacet(unsigned int i) const </div><div class="ttdoc">The function returns a normal to the face number i. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00145">Crystal.hpp:145</a></div></div>
<div class="ttc" id="class_frame_html_aa6e48af345f0a03c5a25ec72c4454057"><div class="ttname"><a href="class_frame.html#aa6e48af345f0a03c5a25ec72c4454057">Frame::Gr</a></div><div class="ttdeci">int ** Gr</div><div class="ttdoc">Numbers of the vertexes from which the facet consist of. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00068">Crystal.hpp:68</a></div></div>
<div class="ttc" id="class_frame_html_ae4b6cfa6b7d944f90fe59af50fbbf620"><div class="ttname"><a href="class_frame.html#ae4b6cfa6b7d944f90fe59af50fbbf620">Frame::K</a></div><div class="ttdeci">unsigned int K</div><div class="ttdoc">Total count of the facets. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00069">Crystal.hpp:69</a></div></div>
<div class="ttc" id="class_beam_html_a01db8ce4e2b6f733ddb9f86b4460c208"><div class="ttname"><a href="class_beam.html#a01db8ce4e2b6f733ddb9f86b4460c208">Beam::EndP</a></div><div class="ttdeci">std::list&lt; unsigned int &gt;::const_iterator EndP(void) const </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00083">Beam.hpp:83</a></div></div>
<div class="ttc" id="class_crystal_html_ad04bd5ec204e07f5bdde263743f53e2c"><div class="ttname"><a href="class_crystal.html#ad04bd5ec204e07f5bdde263743f53e2c">Crystal::Phase</a></div><div class="ttdeci">bool &amp; Phase(void)</div><div class="ttdoc">The function sets whether the optical path is taking into account or not. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00136">Crystal.hpp:136</a></div></div>
<div class="ttc" id="class_crystal_html_a4408bd8102cd48dbd6afa0ded4f60090"><div class="ttname"><a href="class_crystal.html#a4408bd8102cd48dbd6afa0ded4f60090">Crystal::RefI</a></div><div class="ttdeci">complex RefI</div><div class="ttdoc">Real part of refraction index. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00114">Crystal.hpp:114</a></div></div>
<div class="ttc" id="class_crystal_html_aa698b3e27f190194b410fd3e6929ce51"><div class="ttname"><a href="class_crystal.html#aa698b3e27f190194b410fd3e6929ce51">Crystal::mi</a></div><div class="ttdeci">double mi</div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00112">Crystal.hpp:112</a></div></div>
<div class="ttc" id="class_beam_html_a2b26e5f62f5ce4fa9f05c4e6e57c653a"><div class="ttname"><a href="class_beam.html#a2b26e5f62f5ce4fa9f05c4e6e57c653a">Beam::N</a></div><div class="ttdeci">Point3D N</div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00041">Beam.hpp:41</a></div></div>
<div class="ttc" id="class_point3_d_html"><div class="ttname"><a href="class_point3_d.html">Point3D</a></div><div class="ttdoc">The class Point3D contains 3D point in Cartesian coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="_geometry_8hpp_source.html#l00160">Geometry.hpp:160</a></div></div>
<div class="ttc" id="_crystal_8hpp_html"><div class="ttname"><a href="_crystal_8hpp.html">Crystal.hpp</a></div></div>
<div class="ttc" id="class_beam_html_ac18b7f524b8ea54319af49b0e75142cd"><div class="ttname"><a href="class_beam.html#ac18b7f524b8ea54319af49b0e75142cd">Beam::Clear</a></div><div class="ttdeci">void Clear(void)</div><div class="ttdoc">Clears beam vertex list. </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00075">Beam.hpp:75</a></div></div>
<div class="ttc" id="class_beam_html_a0d75fe2046df54caef37336cf4ffabe6"><div class="ttname"><a href="class_beam.html#a0d75fe2046df54caef37336cf4ffabe6">Beam::PushBackP</a></div><div class="ttdeci">void PushBackP(const int &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00098">Beam.hpp:98</a></div></div>
<div class="ttc" id="class_beam_html_a5932942c7a738649a29173849bfa722b"><div class="ttname"><a href="class_beam.html#a5932942c7a738649a29173849bfa722b">Beam::PushFrontP</a></div><div class="ttdeci">void PushFrontP(const int &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00097">Beam.hpp:97</a></div></div>
<div class="ttc" id="beam_8cpp_html_ade74cd1c657f89aec3feae714eab6320"><div class="ttname"><a href="beam_8cpp.html#ade74cd1c657f89aec3feae714eab6320">AreaOfBeam</a></div><div class="ttdeci">double AreaOfBeam(const Beam &amp;bm)</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00108">beam.cpp:108</a></div></div>
<div class="ttc" id="class_beam_splitting_html_a3aa9abcd451d17c2294aedb896003f76"><div class="ttname"><a href="class_beam_splitting.html#a3aa9abcd451d17c2294aedb896003f76">BeamSplitting::Itr</a></div><div class="ttdeci">unsigned int Itr</div><div class="ttdoc">Number of internal reflection. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00039">Crystal.hpp:39</a></div></div>
<div class="ttc" id="class_beam_html_a6bb9554f175f00d3bfcd5085e00076be"><div class="ttname"><a href="class_beam.html#a6bb9554f175f00d3bfcd5085e00076be">Beam::r</a></div><div class="ttdeci">Point3D r</div><div class="ttdoc">direction of the beam in 3D space </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00041">Beam.hpp:41</a></div></div>
<div class="ttc" id="compl_8cpp_html_ada95f00f2bfc5b2f40401e7fd9d088bc"><div class="ttname"><a href="compl_8cpp.html#ada95f00f2bfc5b2f40401e7fd9d088bc">sqrt</a></div><div class="ttdeci">complex sqrt(const complex &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="compl_8cpp_source.html#l00018">compl.cpp:18</a></div></div>
<div class="ttc" id="class_crystal_html_a4742173e9d9c0f25cb4ad4d0bfa9f7a6"><div class="ttname"><a href="class_crystal.html#a4742173e9d9c0f25cb4ad4d0bfa9f7a6">Crystal::FTforConvexCrystal</a></div><div class="ttdeci">double FTforConvexCrystal(Hand Handler) const </div><div class="ttdoc">This function runs the beam splitting algorithm. The realization is in scattering.cpp. </div><div class="ttdef"><b>Definition:</b> <a href="_scattering_8cpp_source.html#l00158">Scattering.cpp:158</a></div></div>
<div class="ttc" id="class_beam_html_a6c845d95aa4324b1a19d4637e4c5049c"><div class="ttname"><a href="class_beam.html#a6c845d95aa4324b1a19d4637e4c5049c">Beam::lng</a></div><div class="ttdeci">double lng</div><div class="ttdoc">optical path of the beam </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00039">Beam.hpp:39</a></div></div>
<div class="ttc" id="class_beam_html_a02e4f12058c4543df6a3b5a33c15f41f"><div class="ttname"><a href="class_beam.html#a02e4f12058c4543df6a3b5a33c15f41f">Beam::Rotate</a></div><div class="ttdeci">Beam &amp; Rotate(Point3D k, Point3D Ey)</div><div class="ttdoc">Rotate Jones matrix of the beam to basis of scattering plane. </div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00141">beam.cpp:141</a></div></div>
<div class="ttc" id="matrix_8cpp_html_aecb251516c02fd2544f242ab0561a125"><div class="ttname"><a href="matrix_8cpp.html#aecb251516c02fd2544f242ab0561a125">norm</a></div><div class="ttdeci">double norm(const matrix &amp;mt)</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8cpp_source.html#l00129">matrix.cpp:129</a></div></div>
<div class="ttc" id="class_crystal_html_a7fb2731da0adf9914b11e9fcf5066308"><div class="ttname"><a href="class_crystal.html#a7fb2731da0adf9914b11e9fcf5066308">Crystal::mr</a></div><div class="ttdeci">double mr</div><div class="ttdoc">Imaginary part of refraction index. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00112">Crystal.hpp:112</a></div></div>
<div class="ttc" id="class_beam_html_ac0da7147ef1655a5487b8984ab777c70"><div class="ttname"><a href="class_beam.html#ac0da7147ef1655a5487b8984ab777c70">Beam::RotatePlane</a></div><div class="ttdeci">Beam RotatePlane(const Point3D &amp;NewE)</div><div class="ttdoc">Rotate Jones matrix to new basis. </div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00408">beam.cpp:408</a></div></div>
<div class="ttc" id="class_beam_html"><div class="ttname"><a href="class_beam.html">Beam</a></div><div class="ttdoc">The Beam class consist of 3D polygon, propagation direction and it&#39;s history, Jones matrix and so on...</div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00029">Beam.hpp:29</a></div></div>
<div class="ttc" id="class_beam_html_ade2d828589f214cc25af43206416393b"><div class="ttname"><a href="class_beam.html#ade2d828589f214cc25af43206416393b">Beam::e</a></div><div class="ttdeci">Point3D e</div><div class="ttdoc">the basis of polarization plane </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00041">Beam.hpp:41</a></div></div>
<div class="ttc" id="class_beam_html_a43e4f0f9235e94a6e53fc3a5d3dfdf39"><div class="ttname"><a href="class_beam.html#a43e4f0f9235e94a6e53fc3a5d3dfdf39">Beam::Begin</a></div><div class="ttdeci">std::list&lt; Point3D &gt;::const_iterator Begin(void) const </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00077">Beam.hpp:77</a></div></div>
<div class="ttc" id="_scattering_8cpp_html_a3ab3c33e22e8dc6b261b0b455963caf3"><div class="ttname"><a href="_scattering_8cpp.html#a3ab3c33e22e8dc6b261b0b455963caf3">Eps2</a></div><div class="ttdeci">const double Eps2</div><div class="ttdef"><b>Definition:</b> <a href="_scattering_8cpp_source.html#l00008">Scattering.cpp:8</a></div></div>
<div class="ttc" id="class_beam_splitting_html_aee0b1d861b8174466de4b3c87b69453d"><div class="ttname"><a href="class_beam_splitting.html#aee0b1d861b8174466de4b3c87b69453d">BeamSplitting::d</a></div><div class="ttdeci">double d</div><div class="ttdoc">distance to far zone </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00044">Crystal.hpp:44</a></div></div>
<div class="ttc" id="_scattering_8cpp_html_a313458e459a6edadbb1173c43e9ff7b2"><div class="ttname"><a href="_scattering_8cpp.html#a313458e459a6edadbb1173c43e9ff7b2">Eps1</a></div><div class="ttdeci">const double Eps1</div><div class="ttdef"><b>Definition:</b> <a href="_scattering_8cpp_source.html#l00007">Scattering.cpp:7</a></div></div>
<div class="ttc" id="main_8cpp_html_a624f88d19899dcade5d794ee32c09ffb"><div class="ttname"><a href="main_8cpp.html#a624f88d19899dcade5d794ee32c09ffb">Handler</a></div><div class="ttdeci">void Handler(Beam &amp;bm)</div><div class="ttdoc">&lt; handler for the emitted beams </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00262">main.cpp:262</a></div></div>
<div class="ttc" id="class_beam_splitting_html_a6606ec0292151c801624986bd16e38d3"><div class="ttname"><a href="class_beam_splitting.html#a6606ec0292151c801624986bd16e38d3">BeamSplitting::Facets</a></div><div class="ttdeci">unsigned int ** Facets</div><div class="ttdoc">Mask for calculation only specified trajectories. </div><div class="ttdef"><b>Definition:</b> <a href="_crystal_8hpp_source.html#l00048">Crystal.hpp:48</a></div></div>
<div class="ttc" id="service_8hpp_html_a326c724913d3f080754a57ebe3892581"><div class="ttname"><a href="service_8hpp.html#a326c724913d3f080754a57ebe3892581">SQR</a></div><div class="ttdeci">T SQR(const T &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="service_8hpp_source.html#l00007">service.hpp:7</a></div></div>
<div class="ttc" id="class_beam_html_ae7cabaf6f67e1f4b9b3c0537dd807ae7"><div class="ttname"><a href="class_beam.html#ae7cabaf6f67e1f4b9b3c0537dd807ae7">Beam::BeginP</a></div><div class="ttdeci">std::list&lt; unsigned int &gt;::const_iterator BeginP(void) const </div><div class="ttdef"><b>Definition:</b> <a href="_beam_8hpp_source.html#l00081">Beam.hpp:81</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 12 2014 15:42:06 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
